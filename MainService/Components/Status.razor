@using MainService.Models
@using MainService.Interfaces
@inject IWorkerService<RedditStatusModel> RedditStatus
@inherits LayoutComponentBase
@page "/"

@if (_redditModel != null)
{
    <StatusTable Status="@_redditModel" OnStop="async taskId => await StopWorker(taskId)" />
}
else
{
    <h5>Loading...</h5>
}


@code {
    private RedditStatusModel _redditModel;

    protected override async Task OnInitializedAsync()
    {
        _redditModel = await RedditStatus.GetStatus();
    }

    private async Task StopWorker(int taskId)
    {
        var result = await RedditStatus.StopWorker(taskId);

        if (result)
        {
            _redditModel = await RedditStatus.GetStatus();
        }
    }

}
